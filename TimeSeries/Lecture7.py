import numpy as np

y = np.array([1.62434536, 1.98719617, 1.61176108, 0.23404356, 0.20835024, -2.1179662,
              -1.7772783, -2.24935382, -2.1424689, -2.23773417, -0.74708664, -1.82332947,
              -2.7616089, -3.63569774, -2.91591724, -3.4385123, -3.80786085, -4.76978791,
              -5.15241597, -4.60838607, -5.17649067, -4.18829428, -2.48672609, -0.79575907,
              1.21914613, 1.77619176, 1.93876306, 1.02948874, 0.13848555, 0.09305955,
              -0.63139623, -1.4665456, -2.62955207, -4.11389978, -5.57057245, -6.29268466,
              -7.62043943, -7.93096921, -6.15266733, -4.02640327])
y_obs = y[2:].reshape(-1, 1)
col1_short = y[:-2]
col2_short = y[1:-1]
phi = np.column_stack((col2_short, col1_short))
phiT_phi_inv = np.linalg.inv(phi.T @ phi)
phiT_y = phi.T @ y_obs
theta = phiT_phi_inv @ phiT_y
print(theta)
print(theta.T @ np.array([y[-1], y[-2]]))
